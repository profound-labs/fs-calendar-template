\documentclass[
  language=english,
  year=2017,
  altYear=2560,
  %showtrims,
  %varnishmask,
  11pt,
  paperheight=210mm,
  paperwidth=148mm,
  photoYoffset=10mm,
  photoHeight=92mm,
  calendarHeight=60mm,
  calendarY=10mm,
  calendarNotesY=8mm,
  calendarNotesXoffset=-6mm,
  hmargin=17mm,
  calendarStyle=rigel,
  mainFontFamily=Shaker Pali Regular,
  italicFontFamily=Shaker Pali Italic,
  boldFontFamily=Shaker 2 Bold,
]{wallcalendar}

\makeatletter

%\newcommand\photosDir{./src-images/300dpi/}
%\newcommand\thumbsDir{./src-images/thumbs-300dpi/}

\newcommand\photosDir{./src-images/92dpi/}
\newcommand\thumbsDir{./src-images/thumbs-360px/}

\usepackage{calendar-layout}

\renewcommand\monthMarkPositions{%
\setlength\markNormalAbove{-3.4mm}%
\setlength\markNormalRight{1mm}%
\setlength\markMoonAbove{-2.6mm}%
\setlength\markMoonRight{1mm}%
\setlength\markKiteAbove{-0.8mm}%
\setlength\markKiteRight{3mm}%
}

\newcommand*\addressesTitleSize{\@setfontsize\addressesSize{9}{12}}
\renewcommand*\addressesSize{\@setfontsize\addressesSize{8}{10}}

\renewcommand\frontMatterFmt{%
\vspace*{-2\baselineskip}
\fontsize{8}{11}\selectfont%
\setlength{\parskip}{0.7\baselineskip}%
}

% set center for PDF page insertions
% TODO: use pgf page.center?

\newlength\centerX
\newlength\centerY
\setlength\centerX{0.5\paperwidth-0.6\paperwidth}
\setlength\centerY{0.5\paperheight-0.6\paperheight}

\makeatother

\begin{document}

% === Cover ===========================================================

\mbox{}

\coverPageDesk

% === Frontmatter =====================================================

\newpage

\ifvarnishmask
\mbox{}
\else
\FrontMatterText
\fi

% === Months ==========================================================

\newpage

\monthMarkPositions
\TwelveMonths

% === Year Planner ====================================================

\newpage
\mbox{}

\AddToShipoutPictureFG*{\put(\LenToUnit{\centerX},\LenToUnit{\centerY}){%
\begin{minipage}[b][1.2\paperheight][c]{1.2\paperwidth}
\centering
\includegraphics[keepaspectratio, width=\paperwidth]{planner-page.pdf}
\end{minipage}
}}

% === Thumbnails ======================================================

\newpage
\mbox{}

\AddToShipoutPictureFG*{\put(\LenToUnit{\centerX},\LenToUnit{\centerY}){%
\begin{minipage}[b][1.2\paperheight][c]{1.2\paperwidth}
\centering
\includegraphics[keepaspectratio, width=\paperwidth]{thumbs-page.pdf}
\end{minipage}
}}

% === Addresses =======================================================

\newpage

\ifvarnishmask
\mbox{}
\else
\input{./desk_addresses.tex}
\fi

\end{document}
