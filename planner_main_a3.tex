\documentclass[11pt,a4paper,oneside,final]{memoir}

\makeatletter

\usepackage{calc}

\usepackage{geometry}
\geometry{
  paper=a4paper,
  vmargin=7mm,
  hmargin=7mm,
}

\setstocksize{297mm}{210mm}

\setlength{\parindent}{0pt}

\usepackage{layout_planner}

\newcommand\clipRectangle{\clip (-3.5cm,1cm) rectangle (159mm,-240mm);}

\newcommand\calYear{\calendar (cal) [dates=2014-01-01 to 2014-12-31, planner, a3] at (0,0) \moondays;}

\newcommand\calFnMarksLeft{%
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-05-13.north east] {\datefnsize 1};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-07-11.north east] {\datefnsize 2};
\draw[textbody] node [above right=-2mm and -1.5mm of cal-2014-07-12.north east] {\datefnsize 3};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-10-08.north east] {\datefnsize 4};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-10-12.north east] {\datefnsize 5,6,7};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-11-02.north east] {\datefnsize 8};
}

\newcommand\calFnTextLeft{%
\begin{tabular}{p{5cm} p{4cm} p{4cm}}

\parbox[t][16mm][t]{5cm}{\raggedright\bottomlabelsize
\s{1} May 13: \textit{Vesākha Pūjā}\linebreak
\s{2} July 11: \textit{Āsāḷhā Pūjā}\linebreak
\s{3} July 12: \textit{Vassa begins}\linebreak
\s{4} Oct 8: \textit{Pavāraṇā}
} &

\parbox[t][16mm][t]{5cm}{\raggedright\bottomlabelsize
Robe offering ceremonies:\linebreak
\s{5} Oct 12: \textit{Dhammapala}\linebreak
\s{6} Oct 12: \textit{Hartridge}\linebreak
} &

\parbox[t][16mm][t]{5cm}{\raggedright\bottomlabelsize
\s{7} Oct 12: \textit{Santacittarama}\linebreak
\s{8} Nov 2: \textit{Amaravati}
} \\

\end{tabular}
}

\newcommand\calFnMarksRight{%
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-01-16.north east] {\datefnsize 1};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-02-14.north east] {\datefnsize 2};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-06-17.north east] {\datefnsize 3};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-10-19.north east] {\datefnsize 4};
\draw[textbody] node [above right=-3mm and -1.5mm of cal-2014-10-26.north east] {\datefnsize 5};
}

\newcommand\calFnTextRight{%
\begin{tabular}{p{5cm} p{4cm}}
\parbox[t][16mm][t]{5cm}{\raggedright\bottomlabelsize
\s{1} Jan 16: \textit{Ajahn Chah Memorial Day}\linebreak
\s{2} Feb 14: \textit{Māgha Pūjā}\linebreak
\s{3} Jun 17: \textit{Ajahn Chah's Birthday}
} &

\parbox[t][16mm][t]{5cm}{\raggedright\bottomlabelsize
Robe offering ceremonies:\linebreak
\s{4} Oct 19: \textit{Aruna Ratanagiri}\linebreak
\s{5} Oct 26: \textit{Cittaviveka}
} \\
\end{tabular}
}

\makeatother

\begin{document}

{\centering%
\monthFont\monthlabelsize\color{gold}%
\textbf{Forest Sangha Calendar 2014 - 2557}
\par}

\vspace*{3mm}

\raggedright

\begin{tikzpicture}
\clipRectangle;
\calYear;
\calFnMarksLeft;
\astromoondays;
\end{tikzpicture}%

\vfill

\calFnTextLeft

\newpage

{\centering%
\monthFont\monthlabelsize\color{gold}%
\textbf{Forest Sangha Calendar 2014 - 2557}
\par}

\vspace*{3mm}

\begin{tikzpicture}
\clipRectangle;
\begin{scope}[shift={(-194mm,0)}]
\calYear;
\calFnMarksRight;
\astromoondays;
\end{scope}
\end{tikzpicture}%

\vfill

\calFnTextRight

\AddToShipoutPictureFG*{\put(\LenToUnit{148mm},\LenToUnit{9mm})%
{\begin{minipage}[b]{60mm}%
\raggedright
\begin{tikzpicture}%
\calendar (keycal) [dates=2014-07-04 to 2014-07-05, planner, a3] if (equals=2014-07-04) [day text=\MyMoon{2}];
\draw [gold] node (astro) [below right=-3mm and -1.5mm of keycal-2014-07-05.south east] {\MyAstroMoon{2}};
\draw [textbody] node (event) [above right=-3mm and -1.5mm of keycal-2014-07-04.north east] {\datefnsize 3};
\node (daynote) [black, left=5mm of keycal-2014-07-04.west] {\bottomlabelsize moon day, traditional};
\node (astronote) [black, below left=1mm and 0mm of astro.south west] {\bottomlabelsize moon phase, astronomical};
\node (eventnote) [black, above right=0mm and 0mm of event.north east] {\bottomlabelsize event note};
\draw [black!50] (astronote) -- (astro);
\draw [black!50] (daynote) -- (keycal-2014-07-04.west);
\draw [black!50] (eventnote) -- (event);
\end{tikzpicture}%

{\bottomlabelsize Download from {\color{gold}\underline{\textcolor[gray]{0.3}{www.forestsangha.org/calendar}}}}

\end{minipage}%
}}%

\end{document}


